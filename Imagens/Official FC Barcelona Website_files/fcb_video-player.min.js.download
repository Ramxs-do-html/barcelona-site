"use strict";PULSE.app.templates["barca-tv-related-video"]=_.template('<li class="js-thumb content-carousel__thumbnail content-carousel__thumbnail--video content-carousel__thumbnail--show-four" tabindex="0"> <%= TEMPLATE_HELPER.render( obj, \'content-video-item\' ) %> </li>'),PULSE.app.templates.barca_tv_video_description_text=_.template('<div class="barca-tv-video-player__info-text"> <% if( contentTag ) { %> <span class="barca-tv-video-player__tag"> <%= PULSE.I18N.lookup( contentTag ) %> </span> <% } %> <h1 class="barca-tv-video-player__title"><%= title %></h1> <p class="barca-tv-video-player__description"><%= description %></p> </div> <% if ( id ) { %> <div class="barca-tv-video-player__meta-bar"> <div class="barca-tv-video-player__meta-bar-section"> <%= TEMPLATE_HELPER.render( {\n                item: obj\n            }, \'barca-tv-video-entitlement\' ) %> <div class="barca-tv-video-player__duration"> <div class="video-duration"> <span class="visually-hidden"><%= PULSE.I18N.lookup( \'label.duration\' ) %></span> <svg class="video-duration__icon"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="/resources/<%= window.RESOURCE_VERSION %>/i/svg-output/icn.svg#play"></use></svg> <%= durationString %> </div> </div> </div> <div class="barca-tv-video-player__meta-bar-section"> <%= TEMPLATE_HELPER.render( { mediaIds: id, mediaTitles: [ title ], showLabel: true }, \'my-list-cta\' ) %> <div class="barca-tv-video-player__share"> <%= TEMPLATE_HELPER.render( { cssClass: \'js-video-share\' }, \'social-share-expand-btn\' ) %> </div> <div class="barca-tv-video-player__forca-barca"> <div data-widget="forca-barca" data-reaction-type="VIDEO" data-reaction-id="<%= id %>" data-analytics-label="<%= title %>"> <%= TEMPLATE_HELPER.render( { cssClass: \'força-barça--dark\' }, \'forca-barca\' ) %> </div> </div> </div> </div> <% } %> '),PULSE.app.templates["forca-button"]=_.template('<div class="" data-widget="forca-barca" data-reaction-type="VIDEO" data-reaction-id="<%= id %>" data-analytics-label="<%= title %>"> <div class="força-barça js-forca-barca"> <div class="força-barça__label-wrapper"> <div class="força-barça__labels"> <div class="força-barça__title"><%= PULSE.I18N.lookup(\'label.forca-barca\') %></div> <div class="força-barça__section"> <svg class="icon max-claps-fire-icon"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="/resources/<%= window.RESOURCE_VERSION %>/i/svg-output/icn.svg#fire"></use></svg> <div class="força-barça__counter js-forca-barca-counter"></div> </div> </div> </div> <div class="força-barça__icon js-forca-barca-button" role="button" tabindex="0"> <span class="visually-hidden"><%= PULSE.I18N.lookup(\'label.forca-barca\') %></span> <span class="clap-count-disc js-forca-clap-counter"></span> <span class="max-clap-total js-forca-max-clap-total"></span> <svg class="icon hand-icon hand-icon--top" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 191.7 197.6"><path class="fill" d="M111.7 9.1c5.2-6.2 13-6.9 19.2-1.7 6.2 5.2 7.8 13 2.6 19.2L146.6 11c5.2-6.2 14.4-7 20.6-1.8 6.2 5.2 7 14.4 1.8 20.6l-12.5 14.9c5.2-6.2 14.6-6.1 20.8-.9 6.2 5.2 7.8 15.1 2.6 21.3l-16.5 19.6c5.2-6.2 13.8-8.3 20-3.1 6.2 5.2 6.2 13.8 1 20l-52.8 62.9c-27.3 32.5-73.9 38.4-104 13.1s-32.4-72.2-5.1-104.7l21.4-25.3c5.2-6.2 10.9-13.9 17-8.7s10.7 17.5 5.5 23.7l45.3-53.5z" fill="#fff"/><g class="stroke" fill="none" stroke="#ce202c" stroke-width="9" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10"><path class="stroke" d="M80 91.1l66.5-79.3c5.2-6.2 14.4-7 20.6-1.8s7 14.4 1.8 20.6l-66.5 79.3M156.5 45.5c5.2-6.2 14.6-6.1 20.8-.9 6.2 5.2 7.8 15.1 2.6 21.3l-53.2 63.4"/><path class="stroke" d="M163.4 85.5c5.2-6.2 13.8-8.3 20-3.1 6.2 5.2 6.2 13.8 1 20l-52.8 62.9c-27.3 32.5-73.9 38.4-104 13.1s-32.4-72.2-5.1-104.7L44 48.5c5.2-6.2 10.9-13.9 17-8.7s10.7 17.5 5.5 23.7L40.1 95.1l72.2-86c5.2-6.2 13.7-7.6 19.9-2.4 6.2 5.2 6.6 14.5 1.4 20.7"/></g></svg> <svg class="icon hand-icon hand-icon--bottom" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 191.7 197.6"><path class="fill" d="M111.7 9.1c5.2-6.2 13-6.9 19.2-1.7 6.2 5.2 7.8 13 2.6 19.2L146.6 11c5.2-6.2 14.4-7 20.6-1.8 6.2 5.2 7 14.4 1.8 20.6l-12.5 14.9c5.2-6.2 14.6-6.1 20.8-.9 6.2 5.2 7.8 15.1 2.6 21.3l-16.5 19.6c5.2-6.2 13.8-8.3 20-3.1 6.2 5.2 6.2 13.8 1 20l-52.8 62.9c-27.3 32.5-73.9 38.4-104 13.1s-32.4-72.2-5.1-104.7l21.4-25.3c5.2-6.2 10.9-13.9 17-8.7s10.7 17.5 5.5 23.7l45.3-53.5z" fill="#fff"/><g class="stroke" fill="none" stroke="#ce202c" stroke-width="9" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10"><path class="stroke" d="M80 91.1l66.5-79.3c5.2-6.2 14.4-7 20.6-1.8s7 14.4 1.8 20.6l-66.5 79.3M156.5 45.5c5.2-6.2 14.6-6.1 20.8-.9 6.2 5.2 7.8 15.1 2.6 21.3l-53.2 63.4"/><path class="stroke" d="M163.4 85.5c5.2-6.2 13.8-8.3 20-3.1 6.2 5.2 6.2 13.8 1 20l-52.8 62.9c-27.3 32.5-73.9 38.4-104 13.1s-32.4-72.2-5.1-104.7L44 48.5c5.2-6.2 10.9-13.9 17-8.7s10.7 17.5 5.5 23.7L40.1 95.1l72.2-86c5.2-6.2 13.7-7.6 19.9-2.4 6.2 5.2 6.6 14.5 1.4 20.7"/></g></svg> </div> </div> </div>'),PULSE.app.templates["multi-event-button"]=_.template('<div class="video-timeline__me-wrapper js-me-wrapper" team="<%= team %>" style="left: <%= left %>;"> <button class="video-timeline__me-button js-me-button"><%= count %></button> <div class="video-timeline__me-holder js-me-holder"></div> </div>'),PULSE.app.templates["related-video"]=_.template('<li class="js-thumb" tabindex="0"> <%= TEMPLATE_HELPER.render( obj, \'content-video-item\' ) %> </li> '),PULSE.app.templates["video-timeline-swipe-prompt"]=_.template('<button class="video-timeline__sprompt js-swipe-button"> <svg class="video-timeline__sprompt-icon"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="/resources/<%= window.RESOURCE_VERSION %>/i/svg-output/icn.svg#chunky-arrow"></use></svg> </button>'),PULSE.app.templates["video-timeline-team-lines"]=_.template('<span class="video-timeline__teamline video-timeline__teamline--team1"></span> <span class="video-timeline__teamline video-timeline__teamline--team2"></span>'),PULSE.app.templates["video-timeline-toggle"]=_.template('<button class="video-timeline-toggle__btn"> <svg class="video-timeline-toggle__icon"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="/resources/<%= window.RESOURCE_VERSION %>/i/svg-output/icn.svg#chevron-down"></use></svg> <span class="video-timeline-toggle__text video-timeline-toggle__text--open"> <%= PULSE.I18N.lookup(\'label.view-match-timeline\') %> </span> <span class="video-timeline-toggle__text video-timeline-toggle__text--close"> <%= PULSE.I18N.lookup(\'label.close-match-timeline\') %> </span> </button>'),PULSE.app.templates["video-timeline"]=_.template('<div class="video-timeline__teams"> <div class="video-timeline__team"> <% iconFallbackSizes = { 30: \'badge--above-mobile\' } %> <%= IMAGE_HELPER.renderBadge(obj.teams[0], \'video-timeline__team-badge\', iconFallbackSizes) %> </div> <div class="video-timeline__team"> <%= IMAGE_HELPER.renderBadge(obj.teams[1], \'video-timeline__team-badge\', iconFallbackSizes) %> </div> </div> <div class="video-timeline__timeline js-video-timeline"></div>'),PULSE.app.templates.video_description_text=_.template('<span class="video-description_desc-col"> <span class="video-description__video-info video-description__video-info--mobile"> <% if( contentTag ) { %> <span class="video-description__tag"> <%= PULSE.I18N.lookup( contentTag ) %> </span> <% } %> <span class="video-description__duration"> <span class="visually-hidden">${ cmsutil.i18n.lookup( \'label.duration\' ) }</span> <svg class="icon"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="/resources/<%= window.RESOURCE_VERSION %>/i/svg-output/icn.svg#video-play"></use></svg> <%= durationString %> </span> <span class="video-description__views"> <svg class="icon"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="/resources/<%= window.RESOURCE_VERSION %>/i/svg-output/icn.svg#views"></use></svg> <h2 class="video-meta__value"><%= views %></h2> <h3 class="video-meta__title"><%= PULSE.I18N.lookup( \'label.views\' ) %></h3> </span> </span> <h1 class="video-description__title"><%= title %></h1> <p class="video-description__description"><%= description %></p> <span class="video-description__video-info"> <% if( contentTag ) { %> <span class="video-description__tag"> <%= PULSE.I18N.lookup( contentTag ) %> </span> <% } %> <span class="video-description__duration"> <svg class="icon"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="/resources/<%= window.RESOURCE_VERSION %>/i/svg-output/icn.svg#video-play"></use></svg> <%= durationString %> </span> <% if ( !modal ) { %> <span class="video-description__divider"></span> <time class="video-description__published"> <svg class="icon"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="/resources/<%= window.RESOURCE_VERSION %>/i/svg-output/icn.svg#clock"></use></svg> <%= timeAgo %> </time> <% } %> </span> </span> <% if ( !modal ) { %> <span class="video-description__forca-col"> <div data-widget="forca-barca" data-reaction-type="VIDEO" data-reaction-id="<%= id %>" data-analytics-label="<%= title %>"> <%= TEMPLATE_HELPER.render( { cssClass: \'força-barça--dark\' }, \'forca-barca\' ) %> </div> </span> <% } %> <div class="video-description__mobile-buttons"> <%= TEMPLATE_HELPER.render( { cssClass: \'js-video-share\' }, \'social-share-expand-btn\' ) %> <div data-widget="forca-barca" data-reaction-type="VIDEO" data-reaction-id="<%= id %>" data-analytics-label="<%= title %>"> <%= TEMPLATE_HELPER.render( { cssClass: \'força-barça--dark força-barça--small\' }, \'forca-barca\' ) %> </div> </div> '),PULSE.app.templates["video-error-concurrency"]=_.template('<section class="video-overlay video-overlay--concurrency"> <% if ( title ) { %> <picture class="video-overlay__background"> <source srcset="" data-image-src="<%= variantImageDesktop %>, <%= variantImageDesktopRetina %> x2 "> <img class="video-overlay__photo" src="<%= variantImageDesktop %>" alt="<%= title %>"> </picture> <% } %> <div class="video-overlay__content"> <header class="video-overlay__header"> <svg class="video-overlay__fcb-logo"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="/resources/<%= window.RESOURCE_VERSION %>/i/svg-output/icn.svg#fcbarcelona"></use></svg> </header> <div class="video-overlay__body"> <h2 class="video-overlay__title"><%= PULSE.I18N.lookup(\'label.concurrency-error.title\') %></h2> <div class="video-overlay__description"><%= PULSE.I18N.lookup(\'label.concurrency-error.description\') %></div> <div class="video-overlay__cta"> <a href="<%= \'//\' + PULSE.app.environment.barcaTVPlusDomain + \'/\' + PULSE.app.language %>" class="button button--primary button--large video-overlay__action"> <%= PULSE.I18N.lookup(\'label.concurrency-error.cta\') %> </a> </div> </div> </div> </section> '),PULSE.app.templates["video-error-general"]=_.template('<div class="video-error"> <div class="video-error__icon"> <svg><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="/resources/<%= window.RESOURCE_VERSION %>/i/svg-output/icn.svg#exclamation"></use></svg> </div> <h2 class="video-error__heading"><%= PULSE.I18N.lookup(\'label.account.failed\') %></h2> </div>'),PULSE.app.templates["video-error-network"]=_.template("<h1>Network Error</h1>"),PULSE.app.templates["video-error-register"]=_.template('<section class="video-overlay"> <% if ( title ) { %> <picture class="video-overlay__background"> <source srcset="" data-image-src="<%= variantImageDesktop %>, <%= variantImageDesktopRetina %> x2 "> <img class="video-overlay__photo" src="<%= variantImageDesktop %>" alt="<%= title %>"> </picture> <% } %> <div class="video-overlay__content"> <header class="video-overlay__header"> <svg class="video-overlay__fcb-logo"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="/resources/<%= window.RESOURCE_VERSION %>/i/svg-output/icn.svg#fcbarcelona"></use></svg> </header> <div class="video-overlay__body"> <h2 class="video-overlay__title"><%= PULSE.I18N.lookup(\'label.entitlement.barca-tv-register-for-free\') %></h2> <div class="video-overlay__description"><%= PULSE.I18N.lookup(\'label.entitlement.barca-tv-fan-description\') %></div> <div class="video-overlay__list-container"> <ul class="video-overlay__list"> <li><%= PULSE.I18N.lookup(\'label.entitlement.fan-benefit-title-1\') %></li> <li><%= PULSE.I18N.lookup(\'label.entitlement.fan-benefit-title-2\') %></li> <li><%= PULSE.I18N.lookup(\'label.entitlement.fan-benefit-title-3\') %></li> <li><%= PULSE.I18N.lookup(\'label.entitlement.fan-benefit-title-4\') %></li> </ul> </div> <div class="video-overlay__cta"> <button class="button button--primary button--large video-overlay__action js-overlay-register-btn" data-analytics="true" data-analytics-type="registre" data-analytics-section="registre-boto" data-analytics-event="<%= source %>"> <%= PULSE.I18N.lookup(\'label.entitlement-register-now\') %> </button> </div> </div> <div class="video-overlay__already-registered"><%= PULSE.I18N.lookup(\'label.already-registered\') %> <span class="video-overlay__log-in js-overlay-login-btn"> <%= PULSE.I18N.lookup(\'label.login\') %> </span></div> </div> </section> '),PULSE.app.templates["video-error-subscribe"]=_.template('<section class="video-overlay video-overlay--premium <%= loggedInClass %>"> <% if ( title ) { %> <picture class="video-overlay__background"> <source srcset="" data-image-src="<%= variantImageDesktop %>, <%= variantImageDesktopRetina %> x2 "> <img class="video-overlay__photo" src="<%= variantImageDesktop %>" alt="<%= title %>"> </picture> <% } %> <div class="video-overlay__content"> <header class="video-overlay__header"> <div class="video-overlay__premium-header-bg"></div> <svg class="video-overlay__fcb-logo"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="/resources/<%= window.RESOURCE_VERSION %>/i/svg-output/icn.svg#fcbarcelona"></use></svg> </header> <div class="video-overlay__body"> <h2 class="video-overlay__title"><%= PULSE.I18N.lookup(\'label.entitlement.subscribe-to-watch\') %></h2> <div class="video-overlay__description"><%= PULSE.I18N.lookup(\'label.entitlement.barca-tv-fan-description\') %></div> <div class="video-overlay__list-container"> <ul class="video-overlay__list"> <li><%= PULSE.I18N.lookup(\'label.entitlement.premium-benefit-title-1\') %></li> <li><%= PULSE.I18N.lookup(\'label.entitlement.premium-benefit-title-2\') %></li> <li><%= PULSE.I18N.lookup(\'label.entitlement.premium-benefit-title-3\') %></li> <li><%= PULSE.I18N.lookup(\'label.entitlement.premium-benefit-title-4\') %></li> </ul> </div> <div class="video-overlay__payment-container"> <%= PULSE.I18N.lookup(\'label.entitlement-card-payment-options\') %> <svg class="video-overlay__payment-option"> <use xmlns:xlink="http:/www.w3.org/1999/xlink" xlink:href="/resources/<%= window.RESOURCE_VERSION %>/i/svg-output/payment.svg#visa-entitlement"></use> </svg> <svg class="video-overlay__payment-option"> <use xmlns:xlink="http:/www.w3.org/1999/xlink" xlink:href="/resources/<%= window.RESOURCE_VERSION %>/i/svg-output/payment.svg#mastercard-entitlement"></use> </svg> </div> <div class="video-overlay__cta"> <% var encodedTitle = STRING_HELPER.htmlEntities.encode( videoTitle ); %> <button class="button button--primary button--large video-overlay__action js-overlay-subscribe-btn" data-analytics="true" data-analytics-type="barca tv subscripcio" data-analytics-section="<%= source %>" data-analytics-event="<%= encodedTitle %>"> <%= PULSE.I18N.lookup(\'label.subscribe\') %> </button> </div> </div> <div class="video-overlay__already-registered"><%= PULSE.I18N.lookup(\'label.already-registered\') %> <span class="video-overlay__log-in js-overlay-premium-login-btn"> <%= PULSE.I18N.lookup(\'label.login\') %> </span></div> </div> </section> '),function(e){const t=function(){const t=this,i=DOM_HELPER.nodeListToArray(document.querySelectorAll(".js-video-player")),a=[];i.forEach((e=>{const t=e.dataset.playerName;-1===a.indexOf(t)&&a.push(t)})),a.forEach((i=>{const a=document.createElement("script");a.src=URL_HELPER.getStreamAMGScriptUrl(e.environment.streamAMG.partnerId,e.environment.streamAMG.uiConfigs[i]),a.type="text/javascript",a.onload=()=>{t.readyCallbacks[i]?(t.readyCallbacks[i].scriptLoaded=!0,t.readyCallbacks[i].callbacks.forEach((e=>e()))):t.readyCallbacks[i]={callbacks:[],scriptLoaded:!0}},document.body.appendChild(a)}))};e.VideoPlayerManager=function(){const e=this;e.players=[],e.readyCallbacks={},t.call(e)},e.VideoPlayerManager.prototype.onKDPReady=function(e,t,i){const a=this;if(a.players.push(t),a.readyCallbacks[i]||(a.readyCallbacks[i]={callbacks:[],scriptLoaded:!1}),a.readyCallbacks[i].scriptLoaded)return e();a.readyCallbacks[i].callbacks.push(e)},e.VideoPlayerManager.prototype.stopOtherPlayers=function(e){this.players.forEach((t=>{if(t===e)return;const i=t.getPlayerElement();i&&i.sendNotification(CONSTANTS.VIDEO_PLAYER_AMG_EVENTS.STOP),"function"==typeof t.hideMiniPlayer&&t.playerElement&&t.hideMiniPlayer()}))},e.PlayerManager=e.PlayerManager||new e.VideoPlayerManager}(PULSE.app),function(e,t,i,a,o){const n="live",l="regular",r={["REGISTER_ERROR"]:"video-error-register",["SUBSCRIBE_ERROR"]:"video-error-subscribe",["NETWORK_ERROR"]:"video-error-network",["CONCURRENCY_ERROR"]:"video-error-concurrency",GENERAL:"video-error-general"},s="premium",d="registration",c="default",E="data-external-id",p="No informat";let u=!1,m=!1,v=!1,S=!1;e.VideoPlayer=function(t){const i=this;i.element=t,e.PlayerManager.onKDPReady((()=>{if(i.init(t),R.call(i),i.initialIds.id){const e="barca tv video page";D(i.initialIds,e)}C(document.querySelectorAll(".".concat("js-footer"," ").concat("a")),2),(BROWSER_HELPER.isIE()||BROWSER_HELPER.isEdge())&&g.call(i),i.element.dispatchEvent(new Event(CONSTANTS.EVENT.VIDEO_PLAYER_INITIALISED))}),this,i.element.dataset.playerName)},e.VideoPlayer.prototype.init=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const a=this;a.element=e,a.autoPlay=i,a.embedAnalyticsModel=t,a.timeSinceLastEvent=0,a.eventTimer=null,a.blockPlaylist=a.element.getAttribute("data-block-playlist"),a.scrollIntoViewMode="true"===a.element.getAttribute("data-scroll-into-view"),a.isEmbedded=!1,a.playerInstance=!1,a.initialIds={id:a.element.getAttribute(CONSTANTS.ATTR.PULSE_CONTENT_ID),mediaId:a.element.getAttribute(E)},a.playingMediaId=parseInt(a.initialIds.id);const o=a.element.getAttribute("data-tags")||"";a.tags=o.split(","),a.isLive="true"===a.element.getAttribute("data-is-live"),a.matchId=a.element.dataset.matchId,a.barcaFans=a.tags.includes(CONSTANTS.TAGS.ENTITLEMENT.FANS.tag),a.premium=a.tags.includes(CONSTANTS.TAGS.ENTITLEMENT.PREMIUM.tag)},e.VideoPlayer.prototype.playerReady=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:p,l=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=this;if(r.isEmbedded=l,r.isEmbedded&&(r.videoDuration=n,r.liveStreaming=!1),r.playerElement=document.getElementById(t),r.element.dispatchEvent(new Event(CONSTANTS.EVENT.VIDEO_PLAYER_READY)),r.playerElement&&r.scrollIntoViewMode&&r.playerElement.scrollIntoView({behavior:"smooth",block:"center"}),r.blockPlaylist&&i.dispatch(a.ActiveVideo.setContinuousPlay(!1)),r.playerElement.kBind(CONSTANTS.EVENT.CINEMA_MODE.CLICKED,(()=>{e.videoLayoutInstance.toggleCinema()})),r.playerElement.kBind(CONSTANTS.VIDEO_PLAYER_AMG_EVENTS.FIRST_PLAY,(()=>{I.call(r,"first play"),k.call(r,"0%")})),r.playerElement.kBind(CONSTANTS.VIDEO_PLAYER_AMG_EVENTS.PLAYED,(()=>{r.eventTimer||(r.eventTimer=setInterval((()=>{r.timeSinceLastEvent++}),CONSTANTS.TIME.ONE_SECOND))})),r.playerElement.kBind(CONSTANTS.VIDEO_PLAYER_AMG_EVENTS.CLOSE_FULL_SCREEN,(()=>{r.playerElement.sendNotification(CONSTANTS.EVENT.CINEMA_MODE.SHOW),BROWSER_HELPER.isIE()||BROWSER_HELPER.isEdge()||r.playerElement.closest("[tabindex]").focus()})),r.playerElement.kBind(CONSTANTS.VIDEO_PLAYER_AMG_EVENTS.OPEN_FULL_SCREEN,(()=>{r.playerElement.sendNotification(CONSTANTS.EVENT.CINEMA_MODE.HIDE)})),r.playerElement.kBind(CONSTANTS.VIDEO_PLAYER_AMG_EVENTS.PLAY_END,(()=>{U.call(r)&&(I.call(r,"complete"),k.call(r,"100%"),i.getState().activeVideo.autoplay&&i.dispatch(a.ActiveVideo.setFromRelated(!1)),i.dispatch(a.ActiveVideo.setPlayState(CONSTANTS.VIDEO_PLAY_STATE.ENDED)))})),r.playerElement.kBind(CONSTANTS.VIDEO_PLAYER_AMG_EVENTS.PAUSED,(()=>{U.call(r)&&(i.dispatch(a.ActiveVideo.setPlayState(CONSTANTS.VIDEO_PLAY_STATE.PAUSED)),I.call(r,"pause"),clearInterval(r.eventTimer),r.eventTimer=null)})),r.playerElement.kBind(CONSTANTS.VIDEO_PLAYER_AMG_EVENTS.REPLAY,(()=>{I.call(r,"first play")})),r.playerElement.kBind(CONSTANTS.VIDEO_PLAYER_AMG_EVENTS.UPDATE_PLAY_HEAD,M.bind(r)),r.playerElement.kBind(CONSTANTS.VIDEO_PLAYER_AMG_EVENTS.SEEKED,M.bind(r)),r.matchId&&r.playerElement.kBind(CONSTANTS.VIDEO_PLAYER_AMG_EVENTS.MEDIA_READY,(()=>{setTimeout((function(){new e.VideoTimeline(r.playerElement,r.matchId)}),800)})),"undefined"!=typeof VIDEO_PERSONALISATION_ENABLED&&"true"===VIDEO_PERSONALISATION_ENABLED&&"undefined"!=typeof _satellite&&!r.isEmbedded){let e=null;void 0!==i.getState().activeVideo.data.personalisationExperiment&&(e=i.getState().activeVideo.data.personalisationExperiment),o.personalisation.trackEvent({eventType:CONSTANTS.TRACK_PERSONALISE_EVENTS.VIDEO_LOADED,eventValue:"true",userId:USER_HELPER.getUserId(),itemId:"undefined"!=typeof fcbDL&&fcbDL.video&&fcbDL.video.id?fcbDL.video.id:r.initialIds.id,metadata:{title:"undefined"!=typeof fcbDL&&fcbDL.video&&fcbDL.video.name?fcbDL.video.name:"N/A",client:"web"},experimentName:e,rankedItems:i.getState().activeVideo.fromRelated?o.personalisation.rankedItems:null})}},e.VideoPlayer.prototype.getPlayerElement=function(){return this.playerElement},e.VideoPlayer.prototype.playVideoWithId=function(e){N.call(this,e)},e.VideoPlayer.prototype.pause=function(){this.playerElement.sendNotification(CONSTANTS.VIDEO_PLAYER_AMG_EVENTS.PAUSE)};const g=function(){this.keyEventCallback=f.bind(this),document.addEventListener("keyup",this.keyEventCallback)},y=function(){const e=this;window.kWidget&&e.config.entry_id&&(window.kWidget.destroy(e.config.targetId),window.kWidget.embed(e.config))},_=function(t,i){const a=this,o=t.getAttribute("data-plugins").split(",").reduce(((e,t)=>(e[t]={plugin:!0},e)),{}),n="dev"!==e.environment.label,l=P.call(a,t),r=e.environment.streamAMG.uiConfigs[l],s={entry_id:t.getAttribute(E),flashvars:{...o,autoMute:!1,autoPlay:a.autoPlay,"audioSelector.defaultLang":(PULSE.app.language||e.defaultLanguage).toLowerCase(),"EmbedPlayer.WebKitPlaysInline":!0,IframeCustomPluginJs1:"".concat(e.environment.cdn,"widgets/fcb_player-plugins").concat(n?".min":"",".js"),IframeCustomPluginCss1:"".concat(e.environment.cdn,"styles/amg-plugins").concat(n?".min":"",".css"),mobileAutoPlay:a.autoPlay,streamerType:"auto",ks:i,"mediaProxy.mediaPlayFrom":h(),closedCaptions:{layout:"ontop",useCookie:!0,defaultLanguageKey:(PULSE.app.language||e.defaultLanguage).toLowerCase()}},readyCallback:a.playerReady.bind(a),targetId:t.getAttribute("data-id"),uiconf_id:r,wid:"_".concat(e.environment.streamAMG.partnerId),trackingDisabled:"preview"===t.getAttribute("data-player-name")};return t.dataset.thumbnailUrl&&(s.flashvars.thumbnailUrl=L(t)),s},h=function(){return new URLSearchParams(window.location.search).get("time")||0},b=function(t){const i=USER_HELPER.getUserUUID();return"".concat(e.environment.tokenApi,"/").concat(t)+URL_HELPER.prepareParams({memberUuid:i,salesforce:!0,lang:e.language,client:"web"})},f=function(e){const t=this;e.keyCode===CONSTANTS.KEY_CODES.ESCAPE&&t.playerElement.contains(e.target)&&(e.stopImmediatePropagation(),t.playerElement.closest("[tabindex]").focus())},L=function(e){const t=e.dataset.thumbnailUrl.split("?");return IMAGE_HELPER.getOdirImageUrl(t[0],e.offsetWidth,e.offsetHeight)},T=function(e){const t=this;t.photo="";const i={tagNames:"entitlement-modal-bg-img"};axios.get(URL_HELPER.generateAPIContentPath("photo","",i)).then((i=>{t.photo=i.data.content.length?i.data.content[0]:"",A.call(t,e)})).catch((i=>{console.warn(i),A.call(t,e)}))},A=function(e){const a=this;let n=i.getState().activeVideo.data.title,l=i.getState().activeVideo.analyticsSource;a.element.getAttribute("data-analytics-source")&&(l=a.element.getAttribute("data-analytics-source"));const s=a.element.getAttribute("data-analytics-model");if(s){n=JSON.parse(s).title}const d={loggedInClass:USER_HELPER.isUserLoggedIn()&&a.premium?"video-overlay--is-logged-in":"",title:a.photo.title?a.photo.title:"",videoTitle:n||"",source:l||""};d.title&&(d.variantImageDesktop=IMAGE_HELPER.getPhotoByVariant(a.photo.variants,"Standard Article Hero - Desktop").url,d.variantImageDesktopRetina=IMAGE_HELPER.getPhotoByVariant(a.photo.variants,"Standard Article Hero - Desktop (Retina)").url);const c=r[e]||r.GENERAL;a.errorContainer?a.errorContainer.innerHTML=TEMPLATE_HELPER.render(d,c):(a.errorContainer=document.createElement("div"),t.style.addClass(a.errorContainer,"video-player__wrap--error-overlay"),a.errorContainer.innerHTML=TEMPLATE_HELPER.render(d,c),a.element.replaceWith(a.errorContainer)),a.errorContainer&&a.scrollIntoViewMode&&a.errorContainer.scrollIntoView({behavior:"smooth",block:"center"});const E=a.errorContainer.querySelector(".".concat("js-overlay-login-btn")),p=a.errorContainer.querySelector(".".concat("js-overlay-premium-login-btn")),u=a.errorContainer.querySelector(".".concat("js-overlay-register-btn")),m=a.errorContainer.querySelector(".".concat("js-overlay-subscribe-btn"));E&&A11Y_HELPER.addListener(E,(e=>{e.preventDefault(),"undefined"!=typeof ANALYTICS_HELPER&&ANALYTICS_HELPER.fireAnalyticsOnElement(e),USER_HELPER.subscribe("",window.FLOW_ID_FREE_VIDEO_MODAL_LOGIN)})),p&&A11Y_HELPER.addListener(p,(e=>{e.preventDefault(),"undefined"!=typeof ANALYTICS_HELPER&&ANALYTICS_HELPER.fireAnalyticsOnElement(e),USER_HELPER.subscribe("",window.FLOW_ID_PREMIUM_VIDEO_MODAL_LOGIN)})),u&&A11Y_HELPER.addListener(u,(e=>{e.preventDefault(),"undefined"!=typeof ANALYTICS_HELPER&&ANALYTICS_HELPER.fireAnalyticsOnElement(e),USER_HELPER.subscribe("",window.FLOW_ID_FREE_VIDEO_MODAL_REGISTER)})),m&&(m.setAttribute("data-flow-id-subscribe",window.FLOW_ID_PREMIUM_VIDEO_MODAL_SUBSCRIBE),new o.SubscribeButton(m));const v=a.element.querySelectorAll('[data-analytics="true"]');v.length>0&&"undefined"!=typeof ANALYTICS_HELPER&&ANALYTICS_HELPER.addEventListeners(v)},P=function(e){const t=e.getAttribute("data-player-name");if(t!==c)return t;let i;switch(this.userSubscription){case CONSTANTS.USER_SUBSCRIPTION.PREMIUM:i=s;break;case CONSTANTS.USER_SUBSCRIPTION.REGISTERED:i=d;break;default:i=c}return i},N=function(e){const t=this,r=t.isLive?n:l;(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l;return new Promise(((i,a)=>{const o={headers:{Authorization:USER_HELPER.getUserIdentityToken(),client:"web","video-type":t}};axios.get(b(e),o).then((e=>{i(e.data.ks)})).catch((e=>{a(e)}))}))})(e.id,r).then((n=>{const l=e.mediaId,r=e.id;t.config=_.call(t,t.element,n),t.errorContainer&&(t.errorContainer.replaceWith(t.element),delete t.errorContainer),t.config.entry_id=l,y.call(t),o.contentTracker(!1,CONSTANTS.CONTENT_TRACKER.ACTION.VIEW,CONSTANTS.CONTENT_TRACKER.TYPE.VIDEO,r),i.getState().activeVideo.playState!==CONSTANTS.VIDEO_PLAY_STATE.PLAYING&&(i.dispatch(a.ActiveVideo.setPlayState(CONSTANTS.VIDEO_PLAY_STATE.LOADING)),i.dispatch(a.ActiveVideo.setCurrentTime(0)))})).catch((e=>{const i=e.response?e.response.data.error:e;T.call(t,i)}))},I=function(e){const t=this;if(t.config.trackingDisabled)return;const i="undefined"!=typeof fcbDL&&fcbDL.hasOwnProperty("video")||t.embedAnalyticsModel;if("undefined"==typeof fcbDL||"undefined"==typeof _satellite||!i)return;if("pause"===e){if(Math.round(t.playerElement.evaluate("{video.player.currentTime}"))>=Math.round(t.playerElement.evaluate("{duration}"))-1)return}let a={};if(t.embedAnalyticsModel){let i=0;"first play"!==e&&(i=t.timeSinceLastEvent),t.timeSinceLastEvent=0,a={videoEvent:e,videoTime:i,videoName:t.embedAnalyticsModel.videoName,videoId:t.embedAnalyticsModel.videoId,videoAudio:t.embedAnalyticsModel.videoAudio,videoDuracio:t.embedAnalyticsModel.videoDuracio,videoStreaming:t.embedAnalyticsModel.videoStreaming,videoPlayerQuality:t.embedAnalyticsModel.videoPlayerQuality,videoSuscripcio:t.embedAnalyticsModel.videoSuscripcio,videoDataEvent:t.embedAnalyticsModel.videoDataEvent,videoDataPublicacio:t.embedAnalyticsModel.videoDataPublicacio,videoDiesDesdePublicacio:t.embedAnalyticsModel.videoDiesDesdePublicacio,videoRelacionat:t.embedAnalyticsModel.videoRelacionat,videoCompeticio:t.embedAnalyticsModel.videoCompeticio,videoTemporada:t.embedAnalyticsModel.videoTemporada,videoCategoria:t.embedAnalyticsModel.videoCategoria}}else fcbDL.video.time="first play"===e?0:t.timeSinceLastEvent,fcbDL.video.event=e,t.timeSinceLastEvent=0,a={videoEvent:e,videoTime:fcbDL.video.time,videoName:fcbDL.video.name,videoId:fcbDL.video.id,videoAudio:fcbDL.video.audio,videoDuracio:fcbDL.video.duracio,videoStreaming:fcbDL.video.streaming,videoPlayerQuality:fcbDL.video.playerQuality,videoSuscripcio:fcbDL.video.suscripcio,videoDataEvent:fcbDL.video.dataEvent,videoDataPublicacio:fcbDL.video.dataPublicacio,videoDiesDesdePublicacio:fcbDL.video.diesDesdePublicacio,videoRelacionat:fcbDL.video.relacionat,videoCompeticio:fcbDL.video.competicio,videoTemporada:fcbDL.video.temporada,videoCategoria:fcbDL.video.categoria};_satellite.setVar(a),_satellite.track("scVideo"),a={}},C=function(e,t){DOM_HELPER.nodeListToArray(e).forEach((e=>{e.setAttribute("tabindex",t)}))},R=function(){const e=this;let t=watch(i.getState,["activeVideo","autoplay"]);i.subscribe(t((t=>{e.autoPlay=t})));let a=watch(i.getState,["activeVideo","data"]);i.subscribe(a(((t,i)=>{USER_HELPER.isUserLoggedIn()&&!e.userSubscription?(e.userSubscription=CONSTANTS.USER_SUBSCRIPTION.REGISTERED,USER_HELPER.checkUserEntitlement(CONSTANTS.USER_ENTITLEMENT_TYPE.PREMIUM_CONTENT).then((t=>{if(!t)throw new Error("Premium user account has expired.");e.userSubscription=CONSTANTS.USER_SUBSCRIPTION.PREMIUM})).catch((e=>{console.error(e)})).finally((()=>{O.call(e,t,i)}))):(e.userSubscription||(e.userSubscription=CONSTANTS.USER_SUBSCRIPTION.NONE),O.call(e,t,i))})))},O=function(e,t){const i=this;!1!==e&&e.mediaId!==t.mediaId?(N.call(i,e),i.playerElement&&i.scrollIntoViewMode&&i.playerElement.scrollIntoView({behavior:"smooth",block:"center"})):!1===e&&i.config&&window.kWidget.destroy(i.config.targetId),!1!==e&&e.title!==t.title&&(i.videoDuration=e.duration,i.liveStreaming=!!(e.tags&&e.tags.length>0)&&V(e.tags),"undefined"!=typeof ANALYTICS_HELPER&&w(e))},V=function(e){return!!e.find((e=>e.label===CONSTANTS.TAGS.LIVE_STREAMING))},D=function(e,t){i.dispatch(a.ActiveVideo.setActiveVideo(e)),i.dispatch(a.ActiveVideo.setVideoSource(t))},w=function(t){if("undefined"==typeof ANALYTICS_HELPER||"undefined"==typeof fcbDL)return;let a;a=!!(t.tags&&t.tags.length>0)&&t.tags.filter((e=>CONSTANTS.TAGS.MATCH_REPLAYS.includes(e.label))).length>0;const o={title:t.title||"",id:t.id,duration:t.duration,isMatchesView:a,language:e.language||e.defaultLanguage,lastModified:t.lastModified,publishFrom:t.publishFrom,references:t.references,tags:t.tags,viaRelatedContent:i.getState().activeVideo.fromRelated};fcbDL=ANALYTICS_HELPER.generateVideoDataLayer(o,!0)},M=function(){const e=this,t=Math.round(e.playerElement.evaluate("{video.player.currentTime}")),o=Math.round(e.playerElement.evaluate("{duration}"));if(i.dispatch(a.ActiveVideo.setCurrentTime(t)),(0===e.videoDuration||isNaN(e.videoDuration)||"No informat"===e.videoDuration)&&(e.videoDuration=o),e.liveStreaming)e.timeSinceLastEvent>=CONSTANTS.TIME.TEN_MINS_IN_SECS&&I.call(e,"streaming");else if(e.videoDuration>0){let i=Math.round(.25*e.videoDuration),a=Math.round(.5*e.videoDuration),o=Math.round(.75*e.videoDuration),n=Math.round(.9*e.videoDuration);i&&t!==i&&(u=!1),a&&t!==a&&(m=!1),o&&t!==o&&(v=!1),n&&t!==n&&(S=!1),t!==i||u?t!==a||m?t!==o||v?t!==n||S||(I.call(e,"segment4"),k.call(e,"90%"),S=!0):(I.call(e,"segment3"),k.call(e,"75%"),v=!0):(I.call(e,"segment2"),k.call(e,"50%"),m=!0):(I.call(e,"segment1"),k.call(e,"25%"),u=!0)}},k=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"0%";const t=this;if(!t.config.trackingDisabled&&"undefined"!=typeof VIDEO_PERSONALISATION_ENABLED&&"true"===VIDEO_PERSONALISATION_ENABLED&&"undefined"!=typeof _satellite){let a=null;void 0!==i.getState().activeVideo.data.personalisationExperiment&&(a=i.getState().activeVideo.data.personalisationExperiment),o.personalisation.trackEvent({eventType:CONSTANTS.TRACK_PERSONALISE_EVENTS.VIDEO_PLAYED,eventValue:e,userId:USER_HELPER.getUserId(),itemId:"undefined"!=typeof fcbDL&&fcbDL.video&&fcbDL.video.id?fcbDL.video.id:t.initialIds.id,metadata:{title:"undefined"!=typeof fcbDL&&fcbDL.video&&fcbDL.video.name?fcbDL.video.name:"N/A",videoTime:t.videoDuration,client:"web"},experimentName:a,rankedItems:i.getState().activeVideo.fromRelated?o.personalisation.rankedItems:null})}},U=function(){const e=i.getState().activeVideo.data.id;return this.playingMediaId===e};e.widgetInitialiser.addMultipleWidgetsByName("video-player",e.VideoPlayer)}(PULSE.app,PULSE.core,PULSE.store,PULSE.app.actions,PULSE.app.common),function(e,t,i,a,o){const n="js-modal-content",l="video-modal--expanded";e.VideoModal=function(e){const t=this;t.container=e,t.prevUrl=window.location.href,t.prevTitle=document.title,t.component={content:t.container.querySelector(".".concat(n))},r.call(t),t.loginFlowId=t.container.dataset.flowIdLogin,t.registerFlowId=t.container.dataset.flowIdRegister,t.subscribeFlowId=t.container.dataset.flowIdSubscribe,t.modal=new a.Modal({closeCallback:s.bind(t),items:document.querySelectorAll(".".concat("js-video-thumbnail")),openCallback:d.bind(t),wrap:t.container})};const r=function(){const e=this;["button","a","li","input",".".concat("js-open-share"),".".concat("js-forca-barca-button"),".".concat(n)].forEach((t=>{A11Y_HELPER.toggleZIndex(e.container,t)}))},s=function(){t.dispatch(i.ActiveVideo.setActiveVideo(!1)),t.dispatch(i.ActiveVideo.setVideoSource(!1)),o.style.removeClass(this.container,l)},d=function(){const e=this,a=e.modal.thumbElement.dataset.title;e.id=e.modal.thumbElement.dataset.pulseId,e.mediaId=e.modal.thumbElement.dataset.externalId,e.sourcePlaylist=e.modal.thumbElement.getAttribute(CONSTANTS.ATTR.PLAYLIST_ID),t.dispatch(i.ActiveVideo.setActiveVideo({id:e.id,mediaId:e.mediaId,sourcePlaylist:e.sourcePlaylist}));const n=e.modal.thumbElement.dataset.analyticsSource;n&&t.dispatch(i.ActiveVideo.setVideoSource(n)),o.style.addClass(e.container,l),"undefined"!=typeof fcbDL&&"undefined"!=typeof _satellite&&(fcbDL.contingut.pageName=URL_HELPER.generateUrl("video",e.id,!1,a,"https"),_satellite.track("scVPage"))},c=document.querySelector('[data-widget="video-modal"]');c&&"true"!==c.getAttribute("data-init")&&(a.videoModal=new e.VideoModal(c),c.setAttribute("data-init","true"))}(PULSE.app,PULSE.store,PULSE.app.actions,PULSE.app.common,PULSE.core),function(e,t,i,a){const o="js-open-share";e.VideoDescription=function(e){const t=this;t.element=e,t.id=parseInt(t.element.getAttribute("data-pulse-id"))||!1,t.modal=t.element.getAttribute("data-modal")||!1,t.updateUrl=!0,t.componentElement={openShareButton:t.element.querySelector(".".concat(o)),description:t.element.querySelector(".".concat("js-description-text")),shareContainer:t.element.querySelector(".".concat("js-video-share")),shareTimeCheckbox:t.element.querySelector(".".concat("js-share-checkbox")),videoTime:t.element.querySelector(".".concat("js-video-time")),urlField:t.element.querySelector(".".concat("js-social-show-text"))},t.componentElement.shareContainer&&(t.pageShare=new i.PageShare(t.componentElement.shareContainer)),t.template=e.dataset.template||"barca_tv_video_description_text",s.call(t),t.subscribe(),l.call(t,0,a.getState().activeVideo.data.title)},e.VideoDescription.prototype.subscribe=function(){const e=this;let t=watch(a.getState,["activeVideo","data"]);a.subscribe(t((t=>{t&&t.title?e.id!==t.id&&(e.id=t.id,n.call(e,t),document.title=t.title):e.id=null})));let i=watch(a.getState,["activeVideo","currentTime"]);a.subscribe(i((t=>{e.onTimeUpdate(t)})))},e.VideoDescription.prototype.onTimeUpdate=function(e){r.call(this,e),l.call(this,e,a.getState().activeVideo.data.title)};const n=function(t){const n=this;n.id=t.id;const r=VIDEO_HELPER.renderViews(t.views);n.componentElement.description.innerHTML=TEMPLATE_HELPER.render({contentTag:TEMPLATE_HELPER.getContentTag(t.tags),description:t.description,durationString:VIDEO_HELPER.formatDuration(VIDEO_HELPER.parseDuration(t.duration)),timeAgo:TEMPLATE_HELPER.wrapInteger(moment(t.publishFrom).fromNow(),"video-description__published-time"),id:t.id,title:t.subtitle||t.title,tags:t.tags||[],views:r,modal:n.modal},n.template),n.componentElement.openShareButton=n.element.querySelector(".".concat(o)),d.call(n),l.call(n,0,a.getState().activeVideo.data.title);DOM_HELPER.nodeListToArray(n.element.querySelectorAll('[data-widget="forca-barca"]')).forEach((e=>{e&&!e.dataset.init&&(e.dataset.init=!0,new i.ForcaBarca(e))}));const s=n.element.querySelectorAll(".js-my-list-cta");for(let t=0;t<s.length;t++)new e.common.MyListCTA(s[t])},l=function(e,t){const i=this;let a=URL_HELPER.generateUrl("videos",i.id,!1,t,"https",i.tags);i.componentElement.shareTimeCheckbox&&i.componentElement.shareTimeCheckbox.checked&&(a+=URL_HELPER.prepareParams({time:e})),i.updateUrl&&i.componentElement.urlField&&(i.componentElement.urlField.innerHTML=a),i.pageShare&&i.pageShare.setUrl(a)},r=function(e){const t=VIDEO_HELPER.parseDuration(e);this.componentElement.videoTime.innerText=VIDEO_HELPER.formatDuration(t)},s=function(){const e=this;d.call(e),e.componentElement.shareTimeCheckbox&&e.componentElement.shareTimeCheckbox.addEventListener("change",(()=>{l.call(e,a.getState().activeVideo.currentTime,a.getState().activeVideo.data.title),e.componentElement.shareTimeCheckbox.checked||e.componentElement.shareTimeCheckbox.blur()})),e.componentElement.urlField&&(e.componentElement.urlField.addEventListener("mouseenter",(()=>{e.updateUrl=!1})),e.componentElement.urlField.addEventListener("mouseleave",(()=>{e.updateUrl=!0})))},d=function(){const e=this;e.componentElement.openShareButton&&A11Y_HELPER.addListener(e.componentElement.openShareButton,(()=>{e.componentElement.openShareButton.blur(),A11Y_HELPER.toggleZIndex(e.componentElement.shareContainer,"li"),A11Y_HELPER.toggleZIndex(e.componentElement.shareContainer,"input"),t.style.toggleClass(e.componentElement.shareContainer,"video-share--active"),t.style.toggleClass(e.componentElement.openShareButton,"video-description__open-share--active")}))},c=document.querySelectorAll('[data-widget="video-description"]');for(let t=0;t<c.length;t++)new e.VideoDescription(c[t])}(PULSE.app,PULSE.core,PULSE.app.common,PULSE.store),function(e,t){e.VideoTimeline=function(e,t){const a=this;a.playerElement=e,a.iframeElement=e.querySelector("iframe"),a.content=a.iframeElement.contentWindow.document,a.controlBar=a.content.querySelector(".controlBarContainer"),a.matchId=t,a.loadingCheckCount=1,i.call(a)};const i=function e(){const t=this;t.scrubberOverlay=t.content.querySelector(".customScrubberOverlay"),t.scrubberOverlay?axios.get(URL_HELPER.getFixtureInfo(t.matchId)).then((e=>e.data)).then((e=>{a.call(t,e),l.call(t),v.call(t),SCREEN_HELPER.onDebouncedResize(v.bind(t))})):t.loadingCheckCount<=10&&(t.loadingCheckCount++,setTimeout(e.bind(t),3e3))},a=function(e){const i=this,a=i.playerElement.closest(".barca-tv-video-player");a&&t.style.addClass(a,"barca-tv-video-player--opta"),i.scrubberWrapper=document.createElement("div"),t.style.addClass(i.scrubberWrapper,"video-timeline"),i.scrubberWrapper.innerHTML=TEMPLATE_HELPER.render(e,"video-timeline"),i.toggleButton=document.createElement("div"),t.style.addClass(i.toggleButton,"video-timeline-toggle"),i.toggleButton.innerHTML=TEMPLATE_HELPER.render(e,"video-timeline-toggle"),i.controlBar.insertBefore(i.scrubberWrapper,i.controlBar.firstElementChild),i.controlBar.insertBefore(i.toggleButton,i.controlBar.firstElementChild),i.timelineWrapper=i.scrubberWrapper.querySelector(".js-video-timeline"),i.timelineWrapper.innerHTML=i.scrubberOverlay.outerHTML,i.scrubberOverlay.parentElement.removeChild(i.scrubberOverlay),i.customScrubberOverlay=i.timelineWrapper.querySelector(".customScrubberOverlay");const l=document.createElement("div");l.innerHTML=TEMPLATE_HELPER.render({},"video-timeline-team-lines"),i.customScrubberOverlay.insertBefore(l,i.customScrubberOverlay.firstElementChild),i.swipePrompt=TEMPLATE_HELPER.stringToHtmlElement(TEMPLATE_HELPER.render({},"video-timeline-swipe-prompt")),i.scrubberWrapper.appendChild(i.swipePrompt),n.call(i),s.call(this),A11Y_HELPER.addListener(i.toggleButton,o.bind(i))},o=function(){t.style.toggleClass(this.scrubberWrapper,"video-timeline--open"),t.style.toggleClass(this.toggleButton,"video-timeline-toggle--open")},n=function(){const e=this;e.timelineWrapper.addEventListener("scroll",(e=>{e.target.scrollLeft>100?t.style.addClass(e.target.parentElement,"video-timeline--is-scrolling"):t.style.removeClass(e.target.parentElement,"video-timeline--is-scrolling")})),A11Y_HELPER.addListener(e.swipePrompt,(()=>{void 0!==e.timelineWrapper.scroll?e.timelineWrapper.scroll({left:1e3,behavior:"smooth"}):e.timelineWrapper.scrollLeft=1e3}))},l=function(){const e=this;e.scrubberWrapper.addEventListener("touchstart",(()=>{e.isSwiping=!1})),e.scrubberWrapper.addEventListener("touchmove",(()=>{e.isSwiping=!0})),e.scrubberWrapper.addEventListener("touchend",(t=>{e.isSwiping||c.call(e,t)})),e.tooltipElement=e.timelineWrapper.querySelector(".hint");const i=DOM_HELPER.nodeListToArray(e.timelineWrapper.querySelectorAll(".opta-soccer-icons-parent")),a={},n={};i.forEach((i=>{const l=i.getAttribute("team");if("true"!==i.dataset.processed&&n[l]){const t=n[l],o=a[l]||[];S(t,i)?(o.includes(t)?o.push(i):o.push(t,i),a[l]=o):o.length&&(r.call(e,o),a[l]=[])}n[l]=i,A11Y_HELPER.addListener(i,(()=>{o.call(e),e.playerElement.sendNotification("doSeek",i.dataset.time)})),i.addEventListener("mouseenter",(()=>{m.call(e,i,e.tooltipElement)})),i.addEventListener("mouseleave",(()=>{t.style.removeClass(e.tooltipElement,"hint--visible")})),i.dataset.processed="true"})),Object.keys(a).forEach((t=>{const i=a[t];i.length&&r.call(e,i)}))},r=function(e){const t=parseFloat(e[0].style.left),i=parseFloat(e[e.length-1].style.left),a="".concat(t+(i-t),"%"),o=TEMPLATE_HELPER.render({left:a,team:e[0].getAttribute("team"),count:e.length},"multi-event-button"),n=TEMPLATE_HELPER.stringToHtmlElement(o);this.customScrubberOverlay.insertBefore(n,e[0]);const l=n.querySelector(".js-me-holder");e.forEach((e=>l.appendChild(e))),d.call(this,n)},s=function(){const e=this.timelineWrapper.querySelector(".icon-soccer-start-time"),i=t.dom.getNextSiblings(e)[0];S(e,i)&&parseFloat(e.style.left)&&(e.style.left="0");const a=this.timelineWrapper.querySelector(".icon-soccer-end-time"),o=t.dom.getPreviousSiblings(a)[0];if(S(a,o)){const e=this.customScrubberOverlay.getBoundingClientRect(),t=a.getBoundingClientRect(),i=o.getBoundingClientRect();if(i.right>t.left){let o=Math.round(10*(i.right-t.left))/10;const n=this.timelineWrapper.getBoundingClientRect();e.width<n.width&&t.right+o>n.right&&(o-=t.right+o-n.right);const l=Math.round(100*o/e.width*10)/10,r=parseFloat(a.style.left);a.style.left="".concat(r+l,"%")}}},d=function(e){const t=this,i=e.querySelector(".js-me-button"),a=e.querySelector(".js-me-holder");i.addEventListener("mouseenter",(e=>{e.target===i&&p.call(t,e.currentTarget.parentElement)})),a.addEventListener("mouseleave",(i=>{i.currentTarget!==e&&u.call(t)}))},c=function(e){const i=this;let a=e.target;t.style.hasClass(a,"hint")?(o.call(i),i.playerElement.sendNotification("doSeek",a.parentElement.dataset.time)):t.style.hasClass(a,"opta-soccer-icons-parent")?(e.preventDefault(),t.style.hasClass(a,CONSTANTS.STYLE_CLS_NAMES.IS_ACTIVE)?E.call(i):m.call(i,a,i.tooltipElement),t.style.hasClass(a.parentElement.parentElement,"js-me-wrapper")||u.call(i)):t.style.hasClass(a,"js-me-wrapper")?(e.preventDefault(),E.call(i),p.call(i,a)):(E.call(i),u.call(i))},E=function(){DOM_HELPER.nodeListToArray(this.timelineWrapper.querySelectorAll(".opta-soccer-icons-parent.".concat(CONSTANTS.STYLE_CLS_NAMES.IS_ACTIVE))).forEach((e=>t.style.removeClass(e,CONSTANTS.STYLE_CLS_NAMES.IS_ACTIVE))),t.style.removeClass(this.tooltipElement,"hint--visible")},p=function(e){if(t.style.hasClass(e,"is-open"))return!1;t.style.addClass(this.customScrubberOverlay,"has-me-open"),t.style.addClass(e,"is-open");const i=e.querySelector(".js-me-holder"),a=DOM_HELPER.nodeListToArray(i.children),o=a[0].offsetWidth+5,n=o*a.length;i.style.width="".concat(n,"px");const l=i.getBoundingClientRect(),r=this.customScrubberOverlay.getBoundingClientRect();l.right+10>r.right?t.style.addClass(i,"video-timeline__me-holder--right-aligned"):l.left-10<r.left&&t.style.addClass(i,"video-timeline__me-holder--left-aligned"),a.forEach(((e,t)=>{const i=o*t+o/2-n/2;e.style.transform="translateX(".concat(i,"px)")}))},u=function(){const e=this,i=DOM_HELPER.nodeListToArray(e.customScrubberOverlay.querySelectorAll(".js-me-wrapper.is-open"));i.length&&(t.style.removeClass(e.customScrubberOverlay,"has-me-open"),i.forEach((e=>{const i=e.querySelector(".js-me-holder"),a=DOM_HELPER.nodeListToArray(i.children);i.style.removeProperty("width"),t.style.removeClass(i,"video-timeline__me-holder--right-aligned"),t.style.removeClass(i,"video-timeline__me-holder--left-aligned"),a.forEach((e=>{e.style.transform=""})),t.style.removeClass(e,"is-open")})))},m=function(e,i){i.innerHTML='<span class="hint__text">'.concat(e.dataset.title,"</span>"),e.appendChild(i),t.style.addClass(e,CONSTANTS.STYLE_CLS_NAMES.IS_ACTIVE),t.style.removeClass(i,"hint--left-aligned"),t.style.removeClass(i,"hint--right-aligned");const a=i.getBoundingClientRect(),o=this.customScrubberOverlay.getBoundingClientRect();a.right+10>o.right?t.style.addClass(i,"hint--right-aligned"):a.left-10<o.left&&t.style.addClass(i,"hint--left-aligned"),t.style.addClass(i,"hint--visible")},v=function(){const e=this;window.matchMedia("(max-width: 640px) and (orientation: portrait)").matches?t.style.addClass(e.content.body,"is-portrait"):t.style.removeClass(e.content.body,"is-portrait")},S=function(e,t){const i=e.getBoundingClientRect(),a=t.getBoundingClientRect();return i.left<a.left+a.width+8&&i.left+i.width+8>a.left&&i.top<a.top+a.height&&i.top+i.height>a.top}}(PULSE.app,PULSE.core),function(e,t,i,a){const o={template:"barca-tv-related-video",stateClasses:{VIDEO_STATE_INACTIVE:[],VIDEO_STATE_PAUSED:["video-thumbnail--playing"],VIDEO_STATE_PLAYING:["video-thumbnail--playing"],VIDEO_STATE_PLAY_ENDED:["video-thumbnail--playing"],VIDEO_STATE_LOADING:["video-thumbnail--playing"],VIDEO_STATE_UP_NEXT:["video-thumbnail--up-next"]},imageVariant:"Thumbnail",imageVariantRetina:"Thumbnail (Retina)"};e.RelatedVideoModel=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=this;i.data=e,i.element=!1,i.config={...o,...t},s.call(i)},e.RelatedVideoModel.prototype.getElement=function(){const e=this;if(e.element)return e.element;const{data:t}=e,i=TEMPLATE_HELPER.render({id:t.id,entitlement:VIDEO_HELPER.getEntitlement(t),leadMedia:t.leadMedia||t.thumbnail||null,title:t.title,subtitle:t.subtitle||"",duration:VIDEO_HELPER.formatDuration(VIDEO_HELPER.parseDuration(t.duration)),url:"",thumbClass:"video-thumbnail--horizontal"},e.config.template);return e.element=TEMPLATE_HELPER.stringToHtmlElement(i),r.call(e,n.call(e)),d.call(e),e.element},e.RelatedVideoModel.prototype.getId=function(){return this.data.id};const n=function(){const e=this,t=i.getState().activeVideo.data;if(!t||t.id.toString()!==e.data.id.toString()){const t=i.getState().activeVideo.nextVideo;return t&&t.id===e.data.id?CONSTANTS.VIDEO_PLAY_STATE.UP_NEXT:CONSTANTS.VIDEO_PLAY_STATE.INACTIVE}return i.getState().activeVideo.playState},l=function(){const e=this;Object.keys(e.config.stateClasses).forEach((i=>{e.config.stateClasses[i].forEach((i=>{e.element&&t.style.removeClass(e.element,i)}))}))},r=function(e){const i=this;l.call(i),i.config.stateClasses[e]&&i.config.stateClasses[e].forEach((function(e){i.element&&t.style.addClass(i.element,e)}))},s=function(){const e=this;let t=watch(i.getState,["activeVideo","playState"]);i.subscribe(t((()=>{const t=n.call(e);r.call(e,t)})));let a=watch(i.getState,["activeVideo","nextVideo"]);i.subscribe(a((()=>{const t=n.call(e);r.call(e,t)})))},d=function(){const e=this;e.element&&A11Y_HELPER.addListener(e.element,(()=>{i.dispatch(a.ActiveVideo.setFromRelated(!0)),i.dispatch(a.ActiveVideo.setActiveVideo(e.data))}))}}(PULSE.app,PULSE.core,PULSE.store,PULSE.app.actions),function(e,t,i,a,o){const n="js-video-list",l="js-running-time",r="js-auto-play",s="js-barca-tv-header-title",d="js-barca-tv-header-link",c="video-playlist-autoplay",E="barca-tv-related-video",p=[/^content-category-/,/^content-tag-/],u=["FOOTBALL_COMPETITION","FOOTBALL_COMPSEASON","FOOTBALL_TEAM","FOOTBALL_CLUB"],m={limit:25,offset:0,sort:"desc"},v="videoPlaylist";e.BarcaTvRelatedVideos=function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const a=this;window.addEventListener("popstate",S.bind(a)),a.container=e,a.config=i,a.config.template=e.dataset.template||E,a.browserButtonUsed=!1,a.componentElement={autoPlay:a.container.querySelector(".".concat(r)),runningTime:a.container.querySelector(".".concat(l)),videoList:a.container.querySelector(".".concat(n)),headerTitle:a.container.querySelector(".".concat(s)),headerLink:a.container.querySelector(".".concat(d))},a.videoModels=[],a.seenVideos=new Set,a.storedVideoData={},a.playlistId=t.url.getParam(v),a.initialId=a.container.getAttribute(CONSTANTS.ATTR.PULSE_CONTENT_ID),a.initialId&&a.seenVideos.add(a.initialId),a.pageSize=Number(a.container.dataset.pageSize),a.paginationConfig={...m},a.pageSize&&!isNaN(a.pageSize)?(m.limit=a.pageSize,a.paginationConfig.limit=a.pageSize):a.pageSize=m.limit,w.call(a),U.call(a)};const S=function(e){const t=this;e.state.video.id?e.state.video.popBy===CONSTANTS.STATE_POP_BY.VIDEO_SIDEBAR&&(t.browserButtonUsed=!0,t.seenVideos=e.state.video.seenVideos,t.paginationConfig=e.state.video.paginationConfig,R.call(t,e.state.video.id)):(t.browserButtonUsed=!0,R.call(t,t.initialId,!0))},g=function(e){for(let t=0;t<p.length;t++){const i=p[t];for(let t=0;t<e.length;t++){const a=e[t];if(i.test(a.label))return{tagNames:a.label}}}return{}},y=function(e){for(let t=0;t<u.length;t++){const i=u[t];for(let t=0;t<e.length;t++){const a=e[t];if(a.type===i)return{references:"".concat(i,":").concat(a.id)}}}return{}},_=function(e,t){const i=this;e.forEach((e=>{i.seenVideos.has(e.id.toString())||A.call(i,{...e,personalisationExperiment:t})}))},h=function(e){const t=this;t.relatedParams||(t.relatedParams=function(e){return{...y(e.references),...g(e.tags)}}(e));const i=URL_HELPER.generateAPIContentPath("video",!1,{...t.relatedParams,...t.paginationConfig});f.call(t,i)},b=function(){const e=this;delete e.playlistId,delete e.relatedParams,e.paginationConfig={...m}},f=function(e,t){const i=this;let a={};"undefined"!=typeof VIDEO_PERSONALISATION_ENABLED&&"true"===VIDEO_PERSONALISATION_ENABLED&&"undefined"!=typeof _satellite&&(a={[CONSTANTS.PERSONALISATION_USER_HEADER]:USER_HELPER.getUserId()}),axios.get(e,{headers:a}).then((e=>{e.data.content.length&&o.personalisation.storeRankedItems(e.data.content.map((e=>e.id))),e.headers[CONSTANTS.PERSONALISATION_HEADER]===CONSTANTS.PERSONALISATION_EXPERIMENT?(e.data.content.length&&o.personalisation.storeRankedItems(e.data.content.map((e=>e.id))),"undefined"!=typeof ANALYTICS_HELPER&&ANALYTICS_HELPER.eventosDTM("personalization","relatedVideos","true")):"undefined"!=typeof ANALYTICS_HELPER&&ANALYTICS_HELPER.eventosDTM("personalization","relatedVideos","false"),T.call(i,e.data.content,e.headers[CONSTANTS.PERSONALISATION_HEADER]),t&&t()})).catch((e=>{console.warn("video sidebar: error fetching initial video data",e)}))},L=function(e){const t=this;if(t.playlistData)return void T.call(t,t.playlistData);const i=URL_HELPER.generateAPIContentPath("playlist",e,{detail:"DETAILED",pageSize:t.pageSize});axios.get(i).then((e=>e.data)).then((e=>{const i=e.items.map((e=>e.response));return t.playlistData||(t.playlistData=i),k.call(t,e),i})).then(T.bind(t)).catch((e=>{console.warn("video sidebar: error fetching initial video data",e)}))},T=function(e,i){const a=this;_.call(a,e,i),H.call(a),M.call(a);const o=I.call(a);O.call(a,o),t.style.removeClass(a.container,"barca-tv-related-videos--loading")},A=function(t){let i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const a=this,o=new e.RelatedVideoModel(t,a.config);if(a.videoModels.push(o),i){const e=o.getElement();e&&a.componentElement.videoList.appendChild(e)}},P=function(e){const t=this;axios.get(URL_HELPER.generateAPIContentPath("video",e)).then((e=>e.data)).then((e=>{A.call(t,e,!1),t.playlistId?L.call(t,t.playlistId):h.call(t,e),i.dispatch(a.ActiveVideo.setActiveVideo(e))}))},N=function(e){const t=this;for(let i=0;i<t.videoModels.length;i++){if(t.videoModels[i].getId().toString()===e.toString())return i}return-1},I=function(){const e=i.getState().activeVideo.data.id,t=N.call(this,e);return-1!==t&&this.videoModels[t+1]},C=function(){const e=this,o=I.call(e);o&&"true"===t.localStorage.getStorage(c)&&(e.paginationConfig.offset++,i.dispatch(a.ActiveVideo.setActiveVideo(o.data)),x.call(e))},R=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o=this,n=N.call(o,e);let l;if(n>-1){l=o.videoModels[n].data}else{if(!o.storedVideoData[e])return;l=o.storedVideoData[e]}t&&(o.playlistId||(o.paginationConfig=m)),i.dispatch(a.ActiveVideo.setActiveVideo(l))},O=function(e){e&&i.dispatch(a.ActiveVideo.setNextVideo(e.data))},V=function(e){return Object.keys(e).length<=3&&e.mediaId&&e.id},D=function(){this.videoModels=[],this.componentElement.videoList.innerHTML=""},w=function(){const e=this;let t=watch(i.getState,["activeVideo","playState"]);i.subscribe(t((t=>{t===CONSTANTS.VIDEO_PLAY_STATE.ENDED&&C.call(e)})));let a=watch(i.getState,["activeVideo","data"]);i.subscribe(a(((t,i)=>{if(!1===t)return void b.call(e);if(t.mediaId===i.mediaId)return;e.storedVideoData[t.id]||(e.storedVideoData[t.id]=t);N.call(e,t.id)>1&&m.limit<100?e.paginationConfig.limit++:V(t)||e.paginationConfig.offset++,D.call(e),e.seenVideos.add(t.id.toString()),P.call(e,t.id),V(t)||(e.browserButtonUsed||VIDEO_HELPER.pushState({id:t.id,mediaId:t.mediaId,paginationConfig:e.paginationConfig,seenVideos:e.seenVideos,popBy:CONSTANTS.STATE_POP_BY.VIDEO_SIDEBAR},t.title),e.browserButtonUsed=!1)})))},M=function(){const e=this,t=e.videoModels.filter((t=>!e.seenVideos.has(t.getId().toString()))).reduce(((e,t)=>e+t.data.duration),0);e.componentElement.runningTime.innerHTML=VIDEO_HELPER.formatDuration(VIDEO_HELPER.parseDuration(t))},k=function(e){const i=this;i.componentElement.headerTitle.innerText=e.title,i.componentElement.headerLink.href=URL_HELPER.getBarcaTvPlaylistUrl(e),t.style.removeClass(i.componentElement.headerLink,CONSTANTS.STYLE_CLS_NAMES.HIDE),t.style.addClass(i.container,"barca-tv-related-videos--playlist")},U=function(){const e=this,o=t.localStorage.getStorage(c);null===o?t.localStorage.setStorage(c,!0):"false"===o&&(e.componentElement.autoPlay.checked=!1),i.dispatch(a.ActiveVideo.setAutoplay(e.componentElement.autoPlay.checked)),e.componentElement.autoPlay.addEventListener("change",(()=>{i.dispatch(a.ActiveVideo.setAutoplay(e.componentElement.autoPlay.checked)),t.localStorage.setStorage(c,e.componentElement.autoPlay.checked)}))},H=function(){const t=this;t.carousel&&t.carousel.teardown(),e.BarcaTvContentCarousel&&(t.carousel=new e.BarcaTvContentCarousel(t.container));const i=t.container.querySelectorAll(".".concat(CONSTANTS.JS_CLS_NAMES.LAZY_PICTURE_ELEMENT));for(let t=0;t<i.length;t++)new e.common.LazyPictureElement(i[t]);const a=t.container.querySelectorAll(".js-my-list-cta");for(let t=0;t<a.length;t++)new e.common.MyListCTA(a[t])},x=function(){const e=this,t=i.getState().activeVideo.data.id,a=N.call(e,t),o=Math.floor(a/e.carousel.itemsPerPage);o>e.carousel.slider.activeSlide?e.carousel.slider.scrollNext():o<e.carousel.slider.activeSlide&&e.carousel.slider.scrollPrev()},B=document.querySelectorAll('[data-widget="barca-tv-related-videos"]');for(let t=0;t<B.length;t++)new e.BarcaTvRelatedVideos(B[t])}(PULSE.app,PULSE.core,PULSE.store,PULSE.app.actions,PULSE.app.common),function(e,t,i){e.VideoPlayerPreview=function(t){let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const a=this;a.container=t,a.primed=!1,e.PlayerManager.onKDPReady((()=>{a.init(t,{},i),a.initialIds.id&&(a.initialIds.id=Number(a.initialIds.id),a.playVideoWithId(a.initialIds),a.primed=!0)}),this,a.container.dataset.playerName)},e.VideoPlayerPreview.prototype=Object.create(e.VideoPlayer.prototype),e.VideoPlayerPreview.prototype.playerReady=function(a){const o=this;e.VideoPlayer.prototype.playerReady.call(o,a,null,!0),o.playerElement.kBind(CONSTANTS.VIDEO_PLAYER_AMG_EVENTS.PLAYED,(()=>{o.initialIds.id&&(t.dispatch(i.ActiveVideo.setActiveVideo(o.initialIds)),t.dispatch(i.ActiveVideo.setPlayState(CONSTANTS.VIDEO_PLAY_STATE.PLAYING)))}))},e.VideoPlayerPreview.prototype.play=function(){const e=this;e.primed?(e.playerElement.sendNotification(CONSTANTS.VIDEO_PLAYER_AMG_EVENTS.CHANGE_VOLUME,0),e.playerElement.sendNotification(CONSTANTS.VIDEO_PLAYER_AMG_EVENTS.SEEK,0),e.playerElement.sendNotification(CONSTANTS.VIDEO_PLAYER_AMG_EVENTS.PLAY)):(e.initialIds.id=Number(e.initialIds.id),e.playVideoWithId(e.initialIds),e.primed=!0)},e.VideoPlayerPreview.prototype.pause=function(){const e=this;e.primed&&e.playerElement.sendNotification(CONSTANTS.VIDEO_PLAYER_AMG_EVENTS.PAUSE)},e.VideoPlayerPreview.prototype.resume=function(){const e=this;e.primed&&e.playerElement.sendNotification(CONSTANTS.VIDEO_PLAYER_AMG_EVENTS.PLAY)},e.widgetInitialiser.addMultipleWidgetsByName("video-player-preview",e.VideoPlayerPreview),document.dispatchEvent(new Event(CONSTANTS.EVENT.VIDEO_PREVIEW_PLAYER_LOADED))}(PULSE.app,PULSE.store,PULSE.app.actions),function(e,t){e.VideoDescriptionEmbeddable=function(t){e.VideoDescription.call(this,t)},e.VideoDescriptionEmbeddable.prototype=Object.create(e.VideoDescription.prototype),e.VideoDescriptionEmbeddable.prototype.subscribe=function(){const e=this;let i=watch(t.getState,["activeVideo","currentTime"]);t.subscribe(i((i=>{const a=t.getState().activeVideo.data;a&&a.id.toString()===e.id&&e.onTimeUpdate(i)})))}}(PULSE.app,PULSE.store),function(e,t,i,a){const o="no-controls",n="No informat",l={root:null,rootMargin:"0px",threshold:.3},r="video-player__player--mini",s="video-player--mini",d="video-player__player--mini-in",c="video-player__player--mini-top",E="video-player__player--mini-fixed",p="video-player__player--fade-in";e.VideoPlayerEmbeddable=function(i){const a=this;a.container=i;const o=JSON.parse(a.container.dataset.analyticsModel);a.embedVideoTracking={videoName:o.title,videoId:Number(o.id),videoAudio:n,videoDuracio:TEMPLATE_HELPER.contentHasTag(o.tags,"content-type-video--live")?"live":Number(o.duration)||n,videoStreaming:TEMPLATE_HELPER.contentHasTag(o.tags,"content-type-video--live")?"live":"on demand",videoPlayerQuality:n,videoSuscripcio:TEMPLATE_HELPER.contentHasTag(o.tags,"entitlement-type-free")?"obert":"registre",videoDataEvent:(new Date).toDateString()||n,videoDataPublicacio:PUBLISH_DATE_HELPER.getPublishDate(Number(o.publishFrom))||n,videoDiesDesdePublicacio:TEMPLATE_HELPER.contentHasTag(o.tags,"content-type-video--live")?"zero":PUBLISH_DATE_HELPER.getDaysSincePublishDate(Number(o.publishFrom))||n,videoRelacionat:"false",videoCompeticio:COMPETITION_HELPER.getCompetitionId(o.references),videoTemporada:n,videoCategoria:TEMPLATE_HELPER.getTagsAsString(o.tags).split(",").join("|")},e.PlayerManager.onKDPReady((()=>{a.init(i,a.embedVideoTracking);const o=".".concat("js-video-description","-").concat(a.element.getAttribute("data-id")),n=document.querySelector(o);n&&(a.description=new e.VideoDescriptionEmbeddable(n)),a.initialIds.id&&(a.initialIds.id=Number(a.initialIds.id),a.playVideoWithId(a.initialIds)),a.inBlog=S.call(a,a.element),a.inModal=g.call(a,a.element),a.useParentSize="true"===i.getAttribute("data-parent-size"),a.displayMiniPlayer="false"!==i.getAttribute("data-mini-player"),a.parentMinViewport=Number(i.getAttribute("data-parent-min-width"))||0,a.displayMiniPlayer&&(a.onMiniPlayerClick=e=>{e.stopPropagation();if(t.getState().activeVideo.playState===CONSTANTS.VIDEO_PLAY_STATE.PLAYING)return a.playerElement.sendNotification(CONSTANTS.VIDEO_PLAYER_AMG_EVENTS.PAUSE);a.playerElement.sendNotification(CONSTANTS.VIDEO_PLAYER_AMG_EVENTS.PLAY)})}),this,a.container.dataset.playerName)},e.VideoPlayerEmbeddable.prototype=Object.create(e.VideoPlayer.prototype),e.VideoPlayerEmbeddable.prototype.constructor=e.VideoPlayerEmbeddable,e.VideoPlayerEmbeddable.prototype.playerReady=function(o){const n=this;e.VideoPlayer.prototype.playerReady.call(n,o,n.embedVideoTracking.videoDuracio,!0),n.displayMiniPlayer&&v.call(n),n.playerElement.kBind(CONSTANTS.VIDEO_PLAYER_AMG_EVENTS.PLAY,(()=>{t.dispatch(i.ActiveVideo.setPlayState(CONSTANTS.VIDEO_PLAY_STATE.PLAYING))})),n.playerElement.kBind(CONSTANTS.VIDEO_PLAYER_AMG_EVENTS.PLAYED,(()=>{n.initialIds.id&&(e.PlayerManager.stopOtherPlayers(n),t.dispatch(i.ActiveVideo.setActiveVideo(n.initialIds)),t.dispatch(i.ActiveVideo.setPlayState(CONSTANTS.VIDEO_PLAY_STATE.PLAYING)))})),n.playerElement.kBind(CONSTANTS.VIDEO_PLAYER_AMG_EVENTS.PLAY_END,(()=>{t.dispatch(i.ActiveVideo.setPlayState(CONSTANTS.VIDEO_PLAY_STATE.ENDED)),n.hideMiniPlayer()})),n.playerElement.kBind(CONSTANTS.VIDEO_PLAYER_AMG_EVENTS.CLOSE_FULL_SCREEN,(()=>{n.ignoreInitialIntersection=!0,n.observer.observe(n.element)})),n.playerElement.kBind(CONSTANTS.VIDEO_PLAYER_AMG_EVENTS.HAS_CLOSED_FULL_SCREEN,(()=>{n.inModal&&setTimeout((()=>{n.inModal.scrollTop=n.restoreScroll||0}),250)})),n.playerElement.kBind(CONSTANTS.VIDEO_PLAYER_AMG_EVENTS.OPEN_FULL_SCREEN,(()=>{a.style.removeClass(n.playerElement,p),n.observer.unobserve(n.element),n.inModal&&(n.restoreScroll=n.inModal.scrollTop)})),n.inBlog&&n.playerElement.sendNotification(CONSTANTS.VIDEO_PLAYER_AMG_EVENTS.ADD_CLASS,"blog-player")},e.VideoPlayerEmbeddable.prototype.showMiniPlayer=function(){const e=this;e.useParentSize&&window.matchMedia("(min-width: ".concat(e.parentMinViewport,"px)")).matches&&(e.playerElement.style.width="".concat(e.playerElement.offsetWidth,"px"),e.playerElement.style.height="".concat(e.playerElement.offsetHeight,"px")),a.style.addClass(e.playerElement,r),a.style.addClass(e.playerElement,c),a.style.addClass(e.playerElement,E),a.style.addClass(e.element,s),a.style.addClass(e.playerElement,d),e.playerElement.sendNotification(CONSTANTS.VIDEO_PLAYER_AMG_EVENTS.ADD_CLASS,o),e.playerElement.addEventListener("click",e.onMiniPlayerClick,!0)},e.VideoPlayerEmbeddable.prototype.hideMiniPlayer=function(){const e=this;a.style.hasClass(e.playerElement,d)&&(a.style.removeClass(e.playerElement,d),a.style.removeClass(e.playerElement,p),a.style.removeClass(e.element,s),e.playerElement.removeEventListener("click",e.onMiniPlayerClick,!0),e.useParentSize&&window.matchMedia("(min-width: ".concat(e.parentMinViewport,"px)")).matches&&(e.playerElement.style.width="auto",e.playerElement.style.height="auto"),a.style.removeClass(e.playerElement,c),a.style.removeClass(e.playerElement,r),a.style.removeClass(e.playerElement,E),e.playerElement.sendNotification(CONSTANTS.VIDEO_PLAYER_AMG_EVENTS.REMOVE_CLASS,o))};const u=function(){const e=t.getState().activeVideo.data,i=!!e&&e.id===this.initialIds.id,o=t.getState().activeVideo.playState===CONSTANTS.VIDEO_PLAY_STATE.PLAYING,n=t.getState().activeVideo.playState===CONSTANTS.VIDEO_PLAY_STATE.PAUSED,l=a.style.hasClass(this.playerElement,d);return i&&o||i&&n&&l},m=function(e){if(!e)return{};return document.body.getBoundingClientRect().width<=1e3?{rootMargin:"0px",root:null}:{rootMargin:"-300px 0px 0px 0px",root:document.querySelector(".js-mc-main-col")}},v=function(){const e=this;e.observer=new IntersectionObserver((function(t){if(!u.call(e))return;if(e.ignoreInitialIntersection)return void(e.ignoreInitialIntersection=!1);const i=t[0];if(i.intersectionRatio>l.threshold&&1!==i.intersectionRatio)return e.hideMiniPlayer();e.showMiniPlayer()}),e.inBlog?{...l,...m(e.inBlog)}:l),e.observer.observe(e.element)},S=function(e){const t=DOM_HELPER.hasParentWithClass("live-blog-post",e);return t&&a.style.addClass(t,"live-blog-post--top"),t},g=function(e){return DOM_HELPER.hasParentWithClass("js-article-modal-viewport",e)};e.widgetInitialiser.addMultipleWidgetsByName("video-player-embeddable",e.VideoPlayerEmbeddable)}(PULSE.app,PULSE.store,PULSE.app.actions,PULSE.core);