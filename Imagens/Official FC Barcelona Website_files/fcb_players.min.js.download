"use strict";PULSE.app.templates["all-time-stats"]=_.template("<% for ( var count = 0; count < statCount; count++ ) { %> <% var stat = allTimePositionStats[ count ] %> <% if (stat) { %> <li class=\"player-stats-footer__alltime-item\"> <span class=\"player-stats-footer__title\"><%= PULSE.I18N.lookup( 'label.stat.barca.' + ( stat ? stat.name.replace( /_/g, '' ) : '' ) ) %></span> <span class=\"player-stats-footer__value-large\"><%= stat ? stat.value : '0' %></span> </li> <% } %> <% } %> "),PULSE.app.templates["hero-stats"]=_.template('<ul class="player-hero__stats"> <% for ( var count = 0; count < allTime.statCount; count++ ) { %> <% var stat = allTime.positionStats[ count ] %> <% if (stat) { %> <div class="player-hero__stats--single-stat"> <li class="player-hero__stats-item"> <div class="player-hero__stat-title"><%= PULSE.I18N.lookup( \'label.stat.barca.\' + ( stat ? stat.name.replace( /_/g, \'\' ) : \'\' ) ) %></div> <div class="player-hero__stat-value"><%= stat ? stat.value : \'0\' %></div> </li> <% var stat = season.positionStats[ count ] %> <li class="player-hero__stats-item player-hero__stats-item--flex"> <div class="player-hero__stat-season-title"><%= season.seasonTitle %></div> <div class="player-hero__stat-season"><%= stat ? stat.value : \'0\' %></div> </li> </div> <% } %> <% } %> </ul> '),PULSE.app.templates["player-nav-photo"]=_.template('<source srcset="<%= url %>, <%= urlRetina %> 2x"> <img class="player-nav__img" src="<%= url %>" alt="<%= title %>"> '),PULSE.app.templates["season-stats"]=_.template('<% for ( var count = 0; count < statCount; count++ ) { %> <% var stat = positionStats[ count ] %> <% var allTimeStat = allTimeStats[ count ] %> <% if (allTimeStat) { %> <li class="player-stats-footer__season-item"> <span class="player-stats-footer__season-title"><%= seasonTitle %></span> <span class="player-stats-footer__value-small"><%= stat ? stat.value : \'0\' %></span> </li> <% } %> <% } %> '),function(t,e){t.PlayerHeroGeneric=function(t){const a=this;a.container=t,a.heroPhotoElem=a.container.querySelector('[data-widget="hero-photo"]'),a.heroPhotoElem&&new e.HeroPhoto(a.heroPhotoElem)};const a=document.querySelectorAll('[data-widget="player-hero-generic"]');for(let e=0;e<a.length;e++)new t.PlayerHeroGeneric(a[e])}(PULSE.app,PULSE.app.common),function(t,e,a){const s="data-player-id",l=function(t,e){if(!e)return;const l=e.querySelector(".".concat("js-team-list-player-first-name")),o=e.querySelector(".".concat("js-team-list-player-last-name")),r=t.querySelector(".".concat("js-player-nav-name-first")),i=t.querySelector(".".concat("js-player-nav-name-last")),c=t.querySelector(".".concat("js-player-nav-img")),p=Number(e.getAttribute(s)),m=l?l.innerHTML:"",u=o?o.innerHTML:"",S=m?"".concat(m," ").concat(u):u;t.href=window.location.pathname.replace(/\d.*/g,"")+"/"+p+"/"+URL_HELPER.urlifyTitle(S),r.innerHTML=m,i.innerHTML=u,n(c,p),a.style.removeClass(t,"u-hide")},n=function(t,e){const a=URL_HELPER.generateAPIContentPath("bio","",{references:"FOOTBALL_PERSON:"+e});axios.get(a).then((e=>{const a=e.data.content[0];if(a&&a.headshot&&a.headshot.variants&&a.headshot.variants.length>0){const e=IMAGE_HELPER.getVariantsForContentType(a.headshot);t.innerHTML=TEMPLATE_HELPER.render({url:IMAGE_HELPER.getPhotoByVariant(e,"Player Photo Small").url,urlRetina:IMAGE_HELPER.getPhotoByVariant(e,"Player Photo Small (Retina)").url,title:a.headshot.title},"player-nav-photo")}})).catch((function(t){console.warn("Player hero: error fetching",t)}))};t.PlayerHero=function(e){const l=this;l.element=e,l.alltimeOffsets={appearances:parseInt(l.element.getAttribute("data-alltime-appearances-offset")),saves:parseInt(l.element.getAttribute("data-alltime-saves-offset")),goals:parseInt(l.element.getAttribute("data-alltime-goal-offset")),goal_assist:parseInt(l.element.getAttribute("data-alltime-assist-offset")),total_tackle:parseInt(l.element.getAttribute("data-alltime-tackle-offset")),clean_sheet:parseInt(l.element.getAttribute("data-alltime-clean-sheet-offset"))},l.playerId=l.element.getAttribute(s),l.currentTeam=49,l.statsContainer=l.element.querySelector(".".concat("js-player-stats")),l.shirt=l.element.querySelector(".".concat("js-player-hero-shirt")),l.shirtToggle=l.element.querySelector(".".concat("js-player-hero-shirt-toggle")),l.fetchedStats=!1,l.fetchedStats||(l.fetchedStats=!0,function(e){const a={teams:e.currentTeam,detail:2};axios.get(URL_HELPER.getCompetitions(a)).then((t=>t.data.content)).then((e=>COMPETITION_HELPER.getLatestCompSeasons(e,t.competitions[t.environment.label].ES_PL))).then((t=>{e.latestCompseason=t[0];const a=axios.get(URL_HELPER.getPlayerStats(e.playerId,{teams:e.currentTeam,comps:CONSTANTS.FOOTBALL_PLAYER_STATS_COMPETITIONS})),s=axios.get(URL_HELPER.getPlayerStats(e.playerId,{teams:e.currentTeam,compSeasons:CONSTANTS.FOOTBALL_PLAYER_STATS_COMPSEASONS}));return Promise.all([a,s])})).then((t=>{let[a,s]=t;e.renderPlayerStats(a,s)})).catch((function(t){console.warn("Player hero stats: error fetching",t)}))}(l),l.initNav(),l.shirtToggle&&A11Y_HELPER.addListener(l.shirtToggle,(()=>{a.style.toggleClass(l.shirt,"is-active")})))},t.PlayerHero.prototype.initNav=function(){const t=this,e=document.querySelector(".".concat("js-team-list"));if(t.playerNav=document.querySelector(".".concat("js-player-nav")),t.navVisibility(),!e)return;const a=Array.prototype.slice.call(e.querySelectorAll(".".concat("js-team-list-player")));if(!a&&a.length>0)return;const n=a.findIndex((e=>Number(e.getAttribute(s))===Number(t.playerId)));if(-1===n)return;let o,r;0===n?(o=a[a.length-1],r=a[n+1]):n===a.length?(o=a[n-1],r=a[0]):(o=a[n-1],r=a[n+1]);const i=t.element.querySelector(".".concat("js-player-nav-prev")),c=t.element.querySelector(".".concat("js-player-nav-next"));l(i,o),l(c,r)},t.PlayerHero.prototype.navVisibility=function(){const t=this;SCREEN_HELPER.isDesktopView()||SCREEN_HELPER.onDebouncedScroll((()=>{window.scrollY>100?a.style.addClass(t.playerNav,"is-active"):a.style.removeClass(t.playerNav,"is-active")}))},t.PlayerHero.prototype.renderPlayerStats=function(t,e){const s=this,l=CONSTANTS.STATS_FOR_POSITION[e.data.entity.info.position],n=PLAYER_HELPER.getStatsForPosition(t.data.stats,l,s.alltimeOffsets);let o;o=CONSTANTS.FOOTBALL_CURRENT_SEASON_LABEL?CONSTANTS.FOOTBALL_CURRENT_SEASON_LABEL:s.latestCompseason.label.match(CONSTANTS.SEASON_REGEX_MATCH)[0],s.statsContainer.innerHTML=TEMPLATE_HELPER.render({season:{positionStats:PLAYER_HELPER.getStatsForPosition(e.data.stats,l),statCount:l.length,seasonTitle:PULSE.I18N.lookup("label.current-season",{season:o})},allTime:{positionStats:n,statCount:n.length}},"hero-stats"),setTimeout((()=>{a.style.addClass(s.element,"player-hero--is-active")}),100)};const o=document.querySelectorAll('[data-widget="player-hero"]');for(let e=0;e<o.length;e++)new t.PlayerHero(o[e])}(PULSE.app,PULSE.store,PULSE.core),function(t,e){const a="player-stats-footer__list--show",s={D:["appearances","goals","goal_assist"],F:["appearances","goals","goal_assist"],G:["appearances","clean_sheet","saves"],M:["appearances","goals","goal_assist"]},l=function(t,e,a,l,n){const o=a;axios.get(URL_HELPER.getPlayerStats(t,o)).then((t=>t.data)).then((t=>{const e=s[t.entity.info.position],a=PLAYER_HELPER.getStatsForPosition(t.stats,e,l);n(a,a.length)}))},n=function(){const t=this;t.element.addEventListener("mouseenter",r.bind(t)),t.focusContainer.addEventListener("focus",r.bind(t))},o=function(){e.style.addClass(this.allTimeStats,a),e.style.addClass(this.seasonStats,a)},r=function(){const e=this;if(e.fetchedStats)return;e.fetchedStats=!0;const a={teams:e.currentTeam,detail:2,comps:CONSTANTS.FOOTBALL_PLAYER_STATS_COMPETITIONS};l(e.playerId,e.currentTeam,a,e.alltimeOffsets,((a,s)=>{var n,r;e.allTimeStats.innerHTML=TEMPLATE_HELPER.render({allTimePositionStats:a,statCount:s},"all-time-stats"),n=e.currentTeam,r=t=>{if(t.length){let n;e.latestCompseason=t[0],n=CONSTANTS.FOOTBALL_CURRENT_SEASON_LABEL?CONSTANTS.FOOTBALL_CURRENT_SEASON_LABEL:e.latestCompseason.label.match(CONSTANTS.SEASON_REGEX_MATCH)[0];const r={teams:e.currentTeam,detail:2,compSeasons:CONSTANTS.FOOTBALL_PLAYER_STATS_COMPSEASONS};l(e.playerId,e.currentTeam,r,{},(t=>{e.seasonStats.innerHTML=TEMPLATE_HELPER.render({positionStats:t,statCount:s,seasonTitle:PULSE.I18N.lookup("label.current-season",{season:n}),allTimeStats:a},"season-stats"),o.call(e)}))}else o.call(e)},axios.get(URL_HELPER.getCompetitions({teams:n,detail:2})).then((t=>t.data.content)).then((e=>COMPETITION_HELPER.getLatestCompSeasons(e,t.competitions[t.environment.label].ES_PL))).then((t=>r(t)))}))};t.PlayerSliderItem=function(t){const e=this;e.element=t,e.alltimeOffsets={appearances:parseInt(e.element.getAttribute("data-alltime-appearances-offset")),saves:parseInt(e.element.getAttribute("data-alltime-saves-offset")),goals:parseInt(e.element.getAttribute("data-alltime-goal-offset")),goal_assist:parseInt(e.element.getAttribute("data-alltime-assist-offset")),total_tackle:parseInt(e.element.getAttribute("data-alltime-tackle-offset")),clean_sheet:parseInt(e.element.getAttribute("data-alltime-clean-sheet-offset"))},e.playerId=e.element.getAttribute("data-player-id"),e.currentTeam=e.element.getAttribute("data-current-team"),e.allTimeStats=e.element.querySelector(".".concat("js-all-time-stats")),e.focusContainer=e.element.querySelector(".".concat("js-focus-container")),e.seasonStats=e.element.querySelector(".".concat("js-season-stats")),e.fetchedStats=!1,n.call(e)};const i=document.querySelectorAll('[data-widget="player-slider-item"]');for(let e=0;e<i.length;e++)new t.PlayerSliderItem(i[e])}(PULSE.app,PULSE.core),function(t,e){const a="player-slider",s="".concat(a,"__slide-arrow--inactive"),l="".concat(a,"__item-wrap").concat(CONSTANTS.STYLE_CLS_MODIFIERS.ACTIVE),n="".concat(a,"__list--nudge-left"),o="".concat(a,"__list--nudge-right"),r="".concat(a,"__pager--active");t.PlayerSlider=function(t){const i=this;i.container=t,i.itemsPerPage=parseInt(i.container.getAttribute("data-slide")),i.scrollContainer=i.container.querySelector(".".concat("js-slide")),i.mobileScrollEl=i.container.querySelector(".".concat("js-mobile-scroller")),i.thumbElements=i.scrollContainer.querySelectorAll(".".concat("js-thumb")),i.slider=new e.Slider({buttonHideClass:s,container:i.container,itemActiveClass:l,nextButton:i.container.querySelector(".".concat("js-next")),nudgeLeftClass:n,nudgeRightClass:o,pagerActiveClass:r,pagerElements:i.container.querySelectorAll(".".concat("js-pager-btn")),pagerItemsContainer:i.container.querySelector(".".concat("js-pager-items")),perPage:i.itemsPerPage,prevButton:i.container.querySelector(".".concat("js-prev")),slideContainer:i.scrollContainer,sliderElements:i.thumbElements,widgetClass:a}),i.mobileScroller=new e.MobileScroller(i.mobileScrollEl,i.scrollContainer)};const i=document.querySelectorAll('[data-widget="player-slider"]');for(let e=0;e<i.length;e++)new t.PlayerSlider(i[e])}(PULSE.app,PULSE.app.common);